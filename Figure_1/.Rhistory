bm[,2]
library(RVsharing)
source('~/Work/RVsharing/ClonedRepo/inst/scripts/generateData.R')
nGen <- 10
bm <- matrix(nrow = nGen, ncol = 2)
for (n in 1:nGen)
{
ped <- simPedigree(n, function() 2, 0)
len <- length(ped$affected)
ped$affected[(len-2):(len-1)] <- 1
bm[n,1] <- length(ped$id)
print(paste('running', n))
bm[n,2] <- system.time(RVsharing(ped, alleleFreq = 1e-9))[1]
}
const <- bm[nGen,2] / (bm[nGen,1] ^ 2)
plot(bm[,1], bm[,2])
fit <- const * (bm[,1] ^ 2)
lines(bm[,1], fit)
ped <- simPedigree(10, function() 2, 0)
ped <- simPedigree(10, function() 2, 0)
parents <- sapply(ped$id, function(i) c(ped$findex[i], ped$mindex[i]))
founders <- which(parents[1,] == 0)
ped$id
bm <- matrix(nrow=200, ncol=2)
for (nAff in 1:200)
{
aff <- sample(nonFounders, nAff+1)
ped$affected[aff] <- 1
bm[n,1] <- nAff
bm[n,2] <- system.time(RVsharing(ped, alleleFreq = 1e-9))[1]
ped$affected[aff] <- 0
}
ped <- simPedigree(10, function() 2, 0)
parents <- sapply(ped$id, function(i) c(ped$findex[i], ped$mindex[i]))
nonFounders <- which(parents[1,] != 0)
bm <- matrix(nrow=200, ncol=2)
for (nAff in 1:200)
{
aff <- sample(nonFounders, nAff+1)
ped$affected[aff] <- 1
bm[n,1] <- nAff
bm[n,2] <- system.time(RVsharing(ped, alleleFreq = 1e-9))[1]
ped$affected[aff] <- 0
}
ped <- simPedigree(6, function() 2, 0)
parents <- sapply(ped$id, function(i) c(ped$findex[i], ped$mindex[i]))
nonFounders <- which(parents[1,] != 0)
bm <- matrix(nrow=200, ncol=2)
for (nAff in 1:200)
{
aff <- sample(nonFounders, nAff+1)
ped$affected[aff] <- 1
bm[n,1] <- nAff
bm[n,2] <- system.time(RVsharing(ped, alleleFreq = 1e-9))[1]
ped$affected[aff] <- 0
}
ped <- simPedigree(6, function() 2, 0)
parents <- sapply(ped$id, function(i) c(ped$findex[i], ped$mindex[i]))
nonFounders <- which(parents[1,] != 0)
bm <- matrix(nrow=100, ncol=2)
for (nAff in 1:200)
{
aff <- sample(nonFounders, nAff+1)
ped$affected[aff] <- 1
bm[n,1] <- nAff
bm[n,2] <- system.time(RVsharing(ped, alleleFreq = 1e-9))[1]
ped$affected[aff] <- 0
}
ped <- simPedigree(6, function() 2, 0)
parents <- sapply(ped$id, function(i) c(ped$findex[i], ped$mindex[i]))
nonFounders <- which(parents[1,] != 0)
bm <- matrix(nrow=100, ncol=2)
for (nAff in 1:100)
{
aff <- sample(nonFounders, nAff+1)
ped$affected[aff] <- 1
bm[n,1] <- nAff
bm[n,2] <- system.time(RVsharing(ped, alleleFreq = 1e-9))[1]
ped$affected[aff] <- 0
}
seq(1,100,5)
length(seq(1,100,5))
ped <- simPedigree(6, function() 2, 0)
parents <- sapply(ped$id, function(i) c(ped$findex[i], ped$mindex[i]))
nonFounders <- which(parents[1,] != 0)
bm <- matrix(nrow=20, ncol=2)
for (nAff in seq(1,100,5))
{
aff <- sample(nonFounders, nAff+1)
ped$affected[aff] <- 1
n <- ceiling(nAff / 5)
bm[n,1] <- nAff
bm[n,2] <- system.time(RVsharing(ped, alleleFreq = 1e-9))[1]
ped$affected[aff] <- 0
}
plot(bm[,1], bm[,2])
ped <- list()
ped$id <- 1:6
ped$findex <- c(0,0,1,1,1,1)
ped$mindex <- c(0,0,1,1,1,1)
ped$sex <- c(1,2,1,2,1,2)
ped$affected <- rep(0, 6)
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped$id <- 1:6
ped$findex <- c(0,0,1,1,1,1)
ped <- list()
ped$id <- 1:6
ped$findex <- c(0,0,1,1,1,1)
ped$mindex <- c(0,0,2,2,2,2)
ped$sex <- c(1,2,1,2,1,2)
ped$affected <- rep(0, 6)
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$id <- 1:6
ped$findex <- c(0,0,1,1,1,1)
ped$mindex <- c(0,0,2,2,2,2)
ped$sex <- c(1,2,1,2,1,2)
ped$affected <- rep(0, 6)
class(ped) <- 'pedigree'
plot(ped)
ped <- list()
ped$id <- 1:8
ped$findex <- c(0,0,1,1,1,1,3,5)
ped$mindex <- c(0,0,2,2,2,2,4,6)
ped$sex <- c(1,2,1,2,1,2,1,2)
ped$affected <- rep(0, 8)
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped$affected[c(7,8)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$id <- 1:10
ped$findex <- c(0,0,1,1,1,1,1,13,5)
ped$mindex <- c(0,0,2,2,2,2,2,24,6)
ped$sex <- c(1,2,1,2,1,2,1,2,1,2)
ped$affected <- rep(0, 10)
ped$affected[c(9,10)] <- 1
class(ped) <- 'pedigree'
plot(ped)
ped <- list()
ped$id <- 1:10
ped$findex <- c(0,0,1,1,1,1,1,1,3,5)
ped$mindex <- c(0,0,2,2,2,2,2,2,4,6)
ped$sex <- c(1,2,1,2,1,2,1,2,1,2)
ped$affected <- rep(0, 10)
ped$affected[c(9,10)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$id <- 1:10
ped$findex <- c(0,0,1,1,1,1,1,1,3,5,7)
ped$mindex <- c(0,0,2,2,2,2,2,2,4,6,8)
ped$sex <- c(1,2,1,2,1,2,1,2,1,2)
ped$affected <- rep(0, 10)
ped$affected[c(9,10)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$id <- 1:10
ped$findex <- c(0,0,1,1,1,1,1,1,3,5,7)
ped$mindex <- c(0,0,2,2,2,2,2,2,4,6,8)
ped$sex <- c(1,2,1,2,1,2,1,2,1,2,1,2)
ped$affected <- rep(0, 12)
ped$affected[c(11,12)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$id <- 1:10
ped$findex <- c(0,0,1,1,1,1,1,1,3,5,7)
ped$mindex <- c(0,0,2,2,2,2,2,2,4,6,8)
ped$sex <- c(1,2,1,2,1,2,1,2,1,2,1,2)
ped$affected <- rep(0, 12)
ped$affected[c(11,12)] <- 1
class(ped) <- 'pedigree'
plot(ped)
ped$id <- 1:11
ped$findex <- c(0,0,1,1,1,1,1,1,3,5,7)
ped$mindex <- c(0,0,2,2,2,2,2,2,4,6,8)
ped <- list()
ped$id <- 1:11
ped$findex <- c(0,0,1,1,1,1,1,1,3,5,7)
ped$mindex <- c(0,0,2,2,2,2,2,2,4,6,8)
ped$sex <- c(1,2,1,2,1,2,1,2,1,2,1,2)
ped$affected <- rep(0, 12)
ped$affected[c(11,12)] <- 1
class(ped) <- 'pedigree'
plot(ped)
cbind(rep(1,5), rep(2,5))
c(bind(rep(1,5), rep(2,5)))
c(cbind(rep(1,5), rep(2,5)))
c(rbind(rep(1,5), rep(2,5)))
ped$sex <- c(rbind(rep(1,6), rep(2,6)))
ped <- list()
ped$id <- 1:12
ped$findex <- c(0,0,rep(1,6),3,5,7,9)
ped$mindex <- c(0,0,rep(2,6),4,6,8,10)
ped$sex <- c(rbind(rep(1,6), rep(2,6)))
ped$affected <- rep(0, 12)
ped$affected[c(11,12)] <- 1
class(ped) <- 'pedigree'
plot(ped)
ped <- list()
ped$id <- 1:14
ped$findex <- c(0,0,rep(1,8),3,5,7,9)
ped$mindex <- c(0,0,rep(2,8),4,6,8,10)
ped$sex <- c(rbind(rep(1,7), rep(2,7)))
ped$affected <- rep(0, 14)
ped$affected[c(13,14)] <- 1
class(ped) <- 'pedigree'
plot(ped)
ped <- list()
ped$id <- 1:14
ped$findex <- c(0,0,rep(1,8),3,5,7,9)
ped$mindex <- c(0,0,rep(2,8),4,6,8,10)
ped$sex <- c(rbind(rep(1,7), rep(2,7)))
ped$affected <- rep(0, 14)
ped$affected[c(13,14)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
?seq
seq(from=3,by=2,length=8)
ped <- list()
ped$id <- 1:26
ped$findex <- c(0,0,rep(1,16),seq(from=3,by=2,length=8))
ped$mindex <- c(0,0,rep(2,16),seq(from=3,by=2,length=8))
ped$sex <- c(rbind(rep(1,8), rep(2,8)))
ped <- list()
ped$id <- 1:26
ped$findex <- c(0,0,rep(1,16),seq(from=3,by=2,length=8))
ped$mindex <- c(0,0,rep(2,16),seq(from=3,by=2,length=8))
ped$sex <- c(rbind(rep(1,13), rep(2,13)))
ped$affected <- rep(0, 26)
class(ped) <- 'pedigree'
plot(ped)
ped <- list()
ped$id <- 1:26
ped$findex <- c(0,0,rep(1,16),seq(from=3,by=2,length=8))
ped$mindex <- c(0,0,rep(2,16),seq(from=4,by=2,length=8))
ped$sex <- c(rbind(rep(1,13), rep(2,13)))
ped$affected <- rep(0, 26)
ped$affected[c(13,14)] <- 1
class(ped) <- 'pedigree'
plot(ped)
ped$affected[c(19,20)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$findex <- c(0,0,rep(1,16),seq(from=3,by=2,length=8),seq(from=19,by=2,length=4))
ped$mindex <- c(0,0,rep(2,16),seq(from=4,by=2,length=8),seq(from=20,by=2,length=4))
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)))
ped$affected <- rep(0, len)
class(ped) <- 'pedigree'
plot(ped)
ped$affected[c(19,20)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$findex <- c(0,0,rep(1,16),seq(from=3,by=2,length=8),seq(from=19,by=2,length=4),c(27,29))
ped$mindex <- c(0,0,rep(2,16),seq(from=4,by=2,length=8),seq(from=20,by=2,length=4),c(28,30))
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)))
ped$affected <- rep(0, len)
ped$affected[c(19,20)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped$findex <- c(0,0,rep(1,16),seq(from=3,by=2,length=8),seq(from=19,by=2,length=4),c(27,29),31)
ped <- list()
ped$findex <- c(0,0,rep(1,16),seq(from=3,by=2,length=8),seq(from=19,by=2,length=4),c(27,29),31)
ped$mindex <- c(0,0,rep(2,16),seq(from=4,by=2,length=8),seq(from=20,by=2,length=4),c(28,30),32)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)))
ped$affected <- rep(0, len)
ped$affected[c(19,20)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$findex <- c(0,0,rep(1,16),seq(from=3,by=2,length=8),seq(from=19,by=2,length=4),c(27,29),31)
ped$mindex <- c(0,0,rep(2,16),seq(from=4,by=2,length=8),seq(from=20,by=2,length=4),c(28,30),32)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)),1)
ped$affected <- rep(0, len)
ped$affected[c(19,20)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$findex <- c(0,0,rep(1,16),seq(from=3,by=2,length=8),seq(from=19,by=2,length=4),c(27,29),31)
ped$mindex <- c(0,0,rep(2,16),seq(from=4,by=2,length=8),seq(from=20,by=2,length=4),c(28,30),32)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)),1)
ped$affected <- rep(0, len)
ped$affected[c(32,31)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$findex <- c(0,0,rep(1,2))
ped$mindex <- c(0,0,rep(2,2))
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)),1)
ped$affected <- rep(0, len)
ped$affected[c(32,31)] <- 1
class(ped) <- 'pedigree'
plot(ped)
ped <- list()
ped$findex <- c(0,0,rep(1,2))
ped$mindex <- c(0,0,rep(2,2))
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)),1)
ped$affected <- rep(0, len)
class(ped) <- 'pedigree'
plot(ped)
ped <- list()
ped$findex <- c(0,0,1,1,3,3)
ped$mindex <- c(0,0,2,2,4,4)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)),1)
ped$affected <- rep(0, len)
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$findex <- c(0,0,1,1,3,3,5,5)
ped$mindex <- c(0,0,2,2,4,4,6,6)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)),1)
ped$affected <- rep(0, len)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$findex <- c(0,0,1,1,3,3,5,5,7,7)
ped$mindex <- c(0,0,2,2,4,4,6,6,8,8)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)),1)
ped$affected <- rep(0, len)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$findex <- c(0,0,1,1,1,1)
ped$mindex <- c(0,0,2,2,2,2)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)),1)
ped$affected <- rep(0, len)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$findex <- c(0,0,1,1,1,1,3,3,5,5)
ped$mindex <- c(0,0,2,2,2,2,4,4,6,6)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)),1)
ped$affected <- rep(0, len)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped$findex <- c(0,0,1,1,1,1,3,3,5,5,7,9)
ped <- list()
ped$findex <- c(0,0,1,1,1,1,3,3,5,5,7,9)
ped$mindex <- c(0,0,2,2,2,2,4,4,6,6,10,8)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)),1)
ped$affected <- rep(0, len)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$findex <- c(0,0,1,1,0,0,3,3,5,5,7,9)
ped$mindex <- c(0,0,2,2,0,0,4,4,6,6,10,8)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)),1)
ped$affected <- rep(0, len)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$findex <- c(0,0,1,1,0,0,3,4)
ped$mindex <- c(0,0,2,2,0,0,5,6)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- c(rbind(rep(1,len/2), rep(2,len/2)),1)
ped$affected <- rep(0, len)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped$sex <- rep(1,len)
ped$affected <- rep(0, len)
ped <- list()
ped$findex <- c(0,0,1,1,0,0,rep(3,4),rep(5,4))
ped$mindex <- c(0,0,2,2,0,0,rep(4,4),rep(6,4))
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- rep(1,len)
ped$affected <- rep(0, len)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
ped <- list()
ped$findex <- c(0,0,1,1,0,0,rep(3,4),rep(4,4))
ped$mindex <- c(0,0,2,2,0,0,rep(5,4),rep(6,4))
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- rep(1,len)
ped$affected <- rep(0, len)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped <- list()
ped$findex <- c(0,0,1,1,0,0,rep(3,4),rep(4,4),7,8,9,10)
ped$mindex <- c(0,0,2,2,0,0,rep(5,4),rep(6,4),14,13,12,11)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- rep(1,len)
ped$affected <- rep(0, len)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
ped$findex <- c(0,0,1,1,0,0,rep(3,6),rep(4,6))#,7,8,9,10)
ped <- list()
ped$findex <- c(0,0,1,1,0,0,rep(3,6),rep(4,6))#,7,8,9,10)
ped$mindex <- c(0,0,2,2,0,0,rep(5,6),rep(6,6))#,14,13,12,11)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- rep(1,len)
ped$affected <- rep(0, len)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
ped <- list()
ped$findex <- c(0,0,1,1,0,0,rep(3,6),rep(4,6)),7,8,9,10,11,12)
ped$mindex <- c(0,0,2,2,0,0,rep(5,6),rep(6,6)),13,14,15,16,17,18)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- rep(1,len)
ped <- list()
ped <- list()
ped$findex <- c(0,0,1,1,0,0,rep(3,6),rep(4,6)),7,8,9,10,11,12))
ped <- list()
ped$findex <- c(0,0,1,1,0,0,rep(3,6),rep(4,6),7,8,9,10,11,12)
ped$mindex <- c(0,0,2,2,0,0,rep(5,6),rep(6,6),13,14,15,16,17,18)
len <- length(ped$findex)
ped$id <- 1:len
ped$sex <- rep(1,len)
ped$affected <- rep(0, len)
ped$affected[c(3,4)] <- 1
class(ped) <- 'pedigree'
plot(ped)
RVsharing(ped)
length(seq(0.05,0.45,0.05)) * 2 * length(seq(12,48,4))
.45-0.05
0.4/0.05
9
testObj <- c(1,2,3)
save(testObj, file='test.RData')
save(testObj='newName', file='test.RData')
?save
setwd("~/Work/CancerInSilico/Figures/Figure_1")
source('../readData.R')
models <- readFilesAsList('../Data/Figure_1/')
list.files
?list.files
source('../readData.R')
models <- readFilesAsList('../Data/Figure_1/')
models[[1]]
slotNames(models[[1]])
temp <- models[[1]]
temp @cells <- list()
temp
